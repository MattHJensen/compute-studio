{% extends 'base.html' %}

{% load static %}

{% load strings %}
{% load inputs %}
{% block content %}

<form class="inputs-form" method="post" action="/taxcalc/?start_year={{start_year}}&data_source={{data_source}}">
{% csrf_token %}
<input type="hidden" name="has_errors" value="{{ has_errors }}" />
<div class="wrapper">
    <!-- Sidebar -->
    <nav id="sidebar">
        <div class="sidebar-header">
            <h3>Param headers</h3>
        </div>
        <ul class="list-unstyled components">
            <li>
              <label> Start Year:
                <select id="start-year-select" class="form-control">
                  {% for year in start_years %}
                    <option value="{{year}}" {% if year == start_year %} selected {% endif %}>{{year}}</option>
                  {% endfor %}
                </select>
              </label>
            </li>
            <li>
                <label> Principal Data Source:
                  <select id="data-source-select" class="form-control">
                    {% for data in data_sources %}
                      <option value="{{data}}" {% if data == data_source %} selected {% endif %}>{{data}}</option>
                    {% endfor %}
                  </select>
              </label>
            </li>
            <li>
                <a href="/taxcalc" class="btn btn-secondary">Reset Parameters</a>
            </li>
            <li>
              <ul class="list-unstyled components">
                <li class="get-started"><a style="color:inherit;" href="#get-started">Get Started</a></li>
                  {% for param in params %}
                    {% for key, value in param.items %}
                      <li><a style="color:inherit;margin-top:2px;margin-bottom:2px;" href="#{{ key|make_id }}">{{ key }}</a></li>
                    {% endfor %}
                  {% endfor %}
              </ul>
            </li>
            <li>
              <button class="btn btn-block btn-match-nav" type="submit" name="full_calc" value="true" style="margin:10px;margin-left:0px;">Run simulation</button>
            </li>
            <li>
              <button class="btn btn-block btn-match-nav" type="submit" name="quick_calc" value="true" style="margin:10px;margin-left:0px;">Run quick simulation</button>
            </li>
        </ul>
    </nav>
  <div id="content">
    <div class="col-xs-9">
        <div class="inputs-main">

          {% for error in form.non_field_errors %}
              <div class="alert alert-danger text-center lert-dismissible" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                {{ error }}
              </div>
          {% endfor %}

          {% for param in params %}
            {% for key, value in param.items %}
              {% if key != "ubi" %}
                {% if params|is_first:param %}
                  {% include 'taxcalc/default_input.html' with title=key param=value is_first=True %}
                {% else %}
                  {% include 'taxcalc/default_input.html' with title=key param=value is_first=False %}
                {% endif %}
              {% endif %}
            {% endfor %}
          {% endfor %}
        </div> <!-- main -->
      </div>
  </div>
</div>
</form>

  <div class="modal fade" id="current-year-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="myModalLabel">Change Start Year</h4>
        </div>
        <div class="modal-body">
          Warning: This will clear your current inputs.
        </div>
        <div class="modal-footer">
          <a type="button" class="btn btn-default" data-dismiss="modal">Nevermind.</a>
          <a type="button" class="btn btn-primary" id="current-year-link">OK, go for it.</a>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="data-source-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="myModalLabel">Change Data Source</h4>
        </div>
        <div class="modal-body">
          Warning: This will clear your current inputs.
        </div>
        <div class="modal-footer">
          <a type="button" class="btn btn-default" data-dismiss="modal">Nevermind.</a>
          <a type="button" class="btn btn-primary" id="data-source-link">OK, go for it.</a>
        </div>
      </div>
    </div>
  </div>
  <script src="{% static 'js/taxcalc.js' %}"></script>

{% endblock %}
